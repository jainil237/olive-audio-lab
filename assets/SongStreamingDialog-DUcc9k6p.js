import{c as C,r as n,R,j as e,d as p}from"./index-DD_3ITo-.js";import{E as $,S as T,a as I}from"./square-pen-BixWWCKU.js";import{T as O}from"./trash-2-DCQbj37L.js";import{M as q}from"./Modal-BjmM8LHN.js";/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],B=C("info",V),D=({embedHtml:t,minHeight:l=160,fallbackText:o="Embed not available for this track yet.",className:x="",...i})=>{const u=n.useRef(null),[b,h]=R.useState(!0);return n.useEffect(()=>{h(!0)},[t]),n.useEffect(()=>{if(!t)return;const f=u.current;if(!f)return;const r=f.querySelector("iframe");if(!r)return;r.setAttribute("width","100%"),r.style.width="100%",r.classList.add("rounded-2xl"),r.getAttribute("loading")||r.setAttribute("loading","lazy"),r.getAttribute("allow")||r.setAttribute("allow","autoplay *; encrypted-media *; fullscreen *; clipboard-write");const m=()=>h(!1);return r.addEventListener("load",m),()=>r.removeEventListener("load",m)},[t]),t?e.jsxs("div",{ref:u,className:p("relative w-full overflow-hidden rounded-2xl border border-white/10 bg-black/50 shadow-inner",x),style:{minHeight:`${l}px`},children:[e.jsx("div",{className:p("absolute inset-0 z-10 transition-opacity duration-500",b?"opacity-100":"opacity-0 pointer-events-none"),children:i.placeholder}),e.jsx("div",{className:"absolute inset-0 [&>iframe]:h-full [&>iframe]:w-full [&>iframe]:min-h-[160px]",dangerouslySetInnerHTML:{__html:t}})]}):e.jsx("div",{className:p("rounded-2xl border border-dashed border-white/10 bg-black/30 px-4 py-6 text-center text-xs text-zinc-500",x),children:o})},F=({isPlaying:t})=>e.jsx("div",{className:"flex items-end justify-center gap-[2px] h-12 w-full px-4",children:Array.from({length:40}).map((l,o)=>e.jsx("div",{className:`w-1 rounded-t-full bg-gradient-to-t from-lime-500/80 via-lime-400/90 to-white transition-all duration-300 ease-in-out ${t?"animate-music-bar":"h-1 opacity-50"}`,style:{animationDelay:`-${Math.random()*1}s`,animationDuration:`${.4+Math.random()*.6}s`}},o))}),G={apple:"Apple Music",soundcloud:"SoundCloud",primary:"Embedded Player",legacy:"Embedded Player"},H={blue:"bg-blue-500/15",rose:"bg-rose-500/15",purple:"bg-purple-500/15",amber:"bg-amber-500/15",emerald:"bg-emerald-500/15",slate:"bg-slate-500/15"},Q=()=>e.jsx("div",{className:"flex items-end justify-center gap-1",children:Array.from({length:9}).map((t,l)=>e.jsx("div",{className:"w-1.5 rounded-t-full bg-gradient-to-t from-lime-500/10 via-lime-400/40 to-lime-300/90 animate-pulse",style:{height:`${18+l%4*10}px`,animationDelay:`${l*90}ms`}},l))}),L=({text:t="Awaiting Embed"})=>e.jsxs("div",{className:"relative flex h-full min-h-[220px] flex-col items-center justify-center overflow-hidden bg-gradient-to-br from-zinc-900 via-black to-zinc-950",children:[e.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(circle_at_top,_rgba(163,230,53,0.18),_transparent_65%)]"}),e.jsx(Q,{}),e.jsx("p",{className:"mt-6 text-xs uppercase tracking-[0.35em] text-lime-300/70",children:t})]}),ee=({song:t,onPlay:l,isActive:o=!1,isPlaying:x=!1,onOpenStreams:i,isAdmin:u,onEdit:b,onDelete:h,showEmbedPlayer:f=!1})=>{var k,z,E;const[r,m]=n.useState(!1),y=n.useRef(null),c=n.useMemo(()=>{const s=[],d=new Set,w=(a,v)=>{if(typeof v!="string")return;const j=v.trim();if(!j||d.has(j))return;d.add(j);const A=G[a]||a.replace(/(^|_)(\w)/g,(Y,J,P)=>` ${P.toUpperCase()}`).trim();s.push({key:a,label:A,html:j})},_=t.embeds||{};return["apple","soundcloud"].forEach(a=>w(a,_[a])),Object.entries(_).forEach(([a,v])=>{a==="apple"||a==="soundcloud"||w(a,v)}),w("legacy",t.embed),s},[t]),[g,N]=n.useState(null);n.useEffect(()=>{if(c.length>0&&!g){const s=c.find(d=>d.key==="soundcloud");N(s?s.key:c[0].key)}},[c,g]);const S=c.length>0,M=f&&S;return n.useEffect(()=>{const s=d=>{y.current&&!y.current.contains(d.target)&&m(!1)};return document.addEventListener("mousedown",s),()=>document.removeEventListener("mousedown",s)},[]),e.jsxs("div",{className:p("group relative overflow-hidden rounded-3xl border border-zinc-800/60 transition-all duration-500 text-white","hover:border-lime-400/50 hover:shadow-[0_20px_50px_-25px_rgba(163,230,53,0.4)]",H[t.cover]||"bg-zinc-900"),children:[e.jsxs("div",{className:"relative overflow-hidden pt-14 bg-black/40",children:[M?e.jsxs("div",{className:"flex flex-col",children:[c.length>1&&e.jsx("div",{className:"flex items-center gap-1 px-4 mb-2 overflow-x-auto no-scrollbar",children:c.map(s=>e.jsx("button",{onClick:d=>{d.stopPropagation(),N(s.key)},className:p("px-3 py-1.5 text-xs font-medium rounded-t-lg border-b-2 transition-colors whitespace-nowrap",g===s.key?"border-lime-400 text-lime-400 bg-white/5":"border-transparent text-zinc-400 hover:text-white hover:bg-white/5"),children:s.label},s.key))}),c.map(s=>e.jsx("div",{className:p(g===s.key?"block":"hidden"),children:e.jsx(D,{embedHtml:s.html,minHeight:220,className:"rounded-none md:rounded-t-3xl border-t border-white/10",placeholder:e.jsx(L,{text:s.key==="legacy"||s.key==="primary"?"Loading Player":`Loading ${s.label}`})})},s.key))]}):e.jsx(L,{text:"No Embed Available"}),e.jsxs("div",{className:"absolute top-4 right-4 flex items-center gap-2 z-20",children:[i&&e.jsx("button",{type:"button",onClick:s=>{s.stopPropagation(),i(t)},className:"px-4 py-1.5 text-xs font-semibold tracking-wide rounded-full border border-white/20 bg-black/50 backdrop-blur-sm text-white transition-colors hover:text-lime-200 hover:border-lime-300/70",children:"Listen Full Track"}),u&&e.jsxs("div",{className:"relative",ref:y,children:[e.jsx("button",{onClick:s=>{s.stopPropagation(),m(!r)},className:"p-1.5 rounded-full bg-black/40 border border-white/20 text-white hover:bg-black/70 hover:text-lime-300 transition-colors",children:e.jsx($,{size:16})}),r&&e.jsxs("div",{className:"absolute right-0 top-full mt-2 w-36 bg-zinc-950 border border-zinc-800 rounded-xl shadow-xl overflow-hidden flex flex-col",children:[e.jsxs("button",{onClick:s=>{s.stopPropagation(),m(!1),b==null||b(t)},className:"flex items-center gap-2 px-4 py-2 text-xs text-zinc-300 hover:bg-zinc-800 hover:text-white text-left",children:[e.jsx(T,{size:12})," Edit"]}),e.jsxs("button",{onClick:s=>{s.stopPropagation(),m(!1),h==null||h(t.id)},className:"flex items-center gap-2 px-4 py-2 text-xs text-red-400 hover:bg-zinc-800 hover:text-red-300 text-left",children:[e.jsx(O,{size:12})," Delete"]})]})]})]}),e.jsx("div",{className:"absolute top-4 left-4",children:e.jsxs("div",{className:"group/credits relative",children:[e.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-full border border-white/20 bg-black/55 backdrop-blur-md text-white transition-colors group-hover/credits:border-lime-300/70 group-hover/credits:text-lime-200",children:e.jsx(B,{size:14})}),e.jsxs("div",{className:"pointer-events-none absolute left-0 top-10 w-56 rounded-2xl border border-white/15 bg-black/85 p-4 opacity-0 shadow-xl transition-opacity duration-200 group-hover/credits:opacity-100 z-10",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-lime-300/80",children:"Credits"}),e.jsx("p",{className:"mt-2 text-sm font-semibold text-white",children:t.artist}),((k=t.artistIds)==null?void 0:k.length)>1&&e.jsxs("p",{className:"text-xs text-zinc-400",children:["Collaborators: ",t.artistIds.length]}),((z=t.genres)==null?void 0:z.length)>0&&e.jsxs("p",{className:"mt-2 text-xs text-zinc-400",children:["Genres: ",t.genres.join(" • ")]})]})]})}),e.jsxs("div",{className:"absolute bottom-0 left-0 right-0 z-10 pointer-events-none fade-in-up",children:[e.jsx("div",{className:"h-24 bg-gradient-to-t from-black via-black/60 to-transparent absolute bottom-0 left-0 right-0"}),e.jsx("div",{className:"relative z-20 pb-2 opacity-80 mix-blend-screen",children:e.jsx(F,{isPlaying:x})})]})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-start gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-1",children:t.title}),e.jsxs("p",{className:"text-zinc-400 text-sm",children:[t.artist," • ",t.duration]})]}),e.jsx("span",{className:"text-xs font-mono bg-zinc-900/70 text-zinc-300 px-2 py-1 rounded border border-zinc-800 uppercase tracking-widest",children:t.type})]}),e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("div",{className:"flex flex-col",children:((E=t.genres)==null?void 0:E.length)>0&&e.jsx("span",{className:"text-xs text-zinc-500 mt-1",children:t.genres.join(" • ")})})})]})]})},U={spotify:"Spotify",apple:"Apple Music",tidal:"Tidal",qobuz:"Qobuz",youtube:"YouTube Music"},te=({open:t,onClose:l,song:o})=>{if(!o)return null;const x=Object.entries(o.streaming||{}).filter(([,i])=>!!i);return e.jsx(q,{open:t,onClose:l,title:`Listen to ${o.title}`,width:"max-w-lg",children:x.length===0?e.jsx("p",{className:"text-sm text-zinc-400",children:"Streaming links are not available for this track yet."}):e.jsx("div",{className:"space-y-3",children:x.map(([i,u])=>e.jsxs("a",{href:u,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-between rounded-2xl border border-white/10 bg-zinc-900/60 px-4 py-3 text-white transition hover:border-white/40 hover:bg-zinc-800/70",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold",children:U[i]||i}),e.jsx("span",{className:"text-xs text-zinc-400",children:"Open in new tab"})]}),e.jsx(I,{size:18,className:"text-lime-300"})]},i))})})};export{ee as S,te as a};
