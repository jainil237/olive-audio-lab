import{c as q,u as J,a as Q,b as V,r as d,j as e,S as Y,A as g,X as Z}from"./index-Cc9ETlLz.js";import{S as ee,a as te}from"./SongStreamingDialog-BYYPCos2.js";import{M as se}from"./Modal-CQEy1vg2.js";import{P as ae}from"./plus-Bt1b09uS.js";import"./square-pen-Cwn3-Uvg.js";import"./trash-2-B7Vf6_PR.js";/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],re=q("funnel",le);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],ie=q("loader-circle",ne),M={title:"",artistIds:[],price:"",duration:"",type:"",genres:"",spotify:"",apple:"",tidal:"",qobuz:"",embed:"",embedApple:"",embedSoundcloud:"",showOnHome:!1},ue=()=>{var A;const{songs:f,artists:x,addSong:D,updateSong:L,deleteSong:F,songFilter:n,applySongFilter:y,clearSongFilter:j,isAdmin:N,loading:_}=J(),B=Q(),[p,u]=V(),[w,S]=d.useState(null),[s,b]=d.useState(M),[h,v]=d.useState(null),[T,m]=d.useState(!1),[k,z]=d.useState(!1);d.useEffect(()=>{const t=p.get("artists"),a=t?t.split(",").map(o=>o.trim()).filter(Boolean):[],l=(n==null?void 0:n.artistIds)??[],r=a.sort().join(","),i=l.sort().join(",");r!==i&&(a.length===0?j():y({artistIds:a}))},[p,n,y,j]);const C=()=>{u({},{replace:!0})},$=d.useCallback(t=>{const a=String(t),l=p.get("artists"),r=l?l.split(",").filter(Boolean):[],i=new Set(r);i.has(a)?i.delete(a):i.add(a);const o=Array.from(i);o.length===0?u({},{replace:!0}):u({artists:o.join(",")},{replace:!0})},[p,u]),I=d.useMemo(()=>{const t=n==null?void 0:n.artistIds;return t!=null&&t.length?f.filter(a=>{var l;return(l=a.artistIds)!=null&&l.length?a.artistIds.some(r=>t.includes(String(r))):!1}):f},[f,n]),c=t=>{const{name:a,value:l,type:r,checked:i}=t.target;b(o=>({...o,[a]:r==="checkbox"?i:l}))},K=t=>{b(a=>{const l=new Set(a.artistIds),r=String(t);return l.has(r)?l.delete(r):l.add(r),{...a,artistIds:Array.from(l)}})},R=()=>{b({...M,artistIds:x[0]?[String(x[0].id)]:[]}),v(null),m(!0)},U=t=>{var a,l,r,i,o,O,H,P,E;v(t.id),b({title:t.title,artistIds:((a=t.artistIds)==null?void 0:a.map(X=>String(X)))||[],price:((l=t.price)==null?void 0:l.toString())||"",duration:t.duration||"",type:t.type||"",genres:((r=t.genres)==null?void 0:r.join(", "))||"",spotify:((i=t.streaming)==null?void 0:i.spotify)||"",apple:((o=t.streaming)==null?void 0:o.apple)||"",tidal:((O=t.streaming)==null?void 0:O.tidal)||"",qobuz:((H=t.streaming)==null?void 0:H.qobuz)||"",embed:t.embed||"",embedApple:((P=t.embeds)==null?void 0:P.apple)||"",embedSoundcloud:((E=t.embeds)==null?void 0:E.soundcloud)||"",showOnHome:t.showOnHome||!1}),m(!0)},W=async t=>{window.confirm("Are you sure you want to delete this song?")&&await F(t)},G=async t=>{if(t.preventDefault(),!(!s.title||s.artistIds.length===0)){z(!0);try{const a=Object.entries({spotify:s.spotify,apple:s.apple,tidal:s.tidal,qobuz:s.qobuz}).reduce((r,[i,o])=>(o&&(r[i]=o),r),{}),l={title:s.title,artistIds:s.artistIds,price:Number(s.price)||0,duration:s.duration,type:s.type,genres:s.genres.split(",").map(r=>r.trim()).filter(Boolean),streaming:a,streaming:a,embed:s.embed.trim(),embeds:{apple:s.embedApple.trim(),soundcloud:s.embedSoundcloud.trim()},showOnHome:s.showOnHome};h?await L(h,l):await D(l),m(!1)}catch(a){console.error("Failed to save song",a)}finally{z(!1)}}};return e.jsxs("div",{className:"space-y-16 text-white min-h-screen",children:[e.jsxs("section",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between gap-6",children:[e.jsx(Y,{align:"left",eyebrow:"Catalogue",children:"Songs & Albums"}),e.jsx(g,{variant:"ghost",onClick:()=>B("/artists"),children:"Explore collaborators â†’"})]}),e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsx("p",{className:"text-zinc-400 max-w-2xl",children:"Licenses for production, mixing and mastering projects."}),N&&e.jsxs("button",{onClick:R,className:"flex items-center gap-2 px-4 py-2 bg-lime-500/20 text-lime-400 hover:bg-lime-500/30 rounded-full text-sm font-semibold transition-colors border border-lime-500/30",children:[e.jsx(ae,{size:16})," Add Song"]})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-zinc-500 text-sm mr-2",children:[e.jsx(re,{size:14}),e.jsx("span",{children:"Filter by Artist:"})]}),((A=n==null?void 0:n.artistIds)==null?void 0:A.length)>0&&e.jsxs("button",{onClick:C,className:"flex items-center gap-1 px-3 py-2 rounded-full border border-red-500/30 bg-red-500/10 text-red-400 text-sm hover:bg-red-500/20 transition-colors",children:[e.jsx(Z,{size:14})," Clear"]}),x.map(t=>{var l;const a=(l=n==null?void 0:n.artistIds)==null?void 0:l.includes(String(t.id));return e.jsx("button",{type:"button",onClick:()=>$(t.id),className:`px-4 py-2 rounded-full border transition-colors text-sm ${a?"border-lime-400 bg-lime-500/20 text-white":"border-white/10 bg-black/40 text-zinc-300 hover:border-lime-300/60 hover:text-white"}`,children:t.name},t.id)})]})}),_?e.jsxs("div",{className:"flex flex-col items-center justify-center py-32 text-zinc-500",children:[e.jsx(ie,{className:"w-10 h-10 animate-spin mb-4 text-lime-400"}),e.jsx("p",{className:"animate-pulse",children:"Loading library..."})]}):e.jsx("div",{className:"grid gap-6 md:grid-cols-2 xl:grid-cols-3",children:I.length>0?I.map(t=>e.jsx(ee,{song:t,onOpenStreams:S,isAdmin:N,onEdit:U,onDelete:W,showEmbedPlayer:!0},t.id)):e.jsxs("div",{className:"col-span-full py-20 text-center text-zinc-500 border border-dashed border-zinc-800 rounded-2xl",children:[e.jsx("p",{children:"No songs found for this artist."}),e.jsx("button",{onClick:C,className:"mt-4 text-lime-400 hover:underline",children:"Clear filters to see all songs"})]})})]}),e.jsx(se,{open:T,onClose:()=>m(!1),title:h?"Edit Song":"Add New Song",children:e.jsxs("form",{className:"space-y-4",onSubmit:G,children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"md:col-span-2 flex items-center gap-3 p-4 rounded-2xl border border-white/10 bg-black/40",children:[e.jsx("input",{type:"checkbox",name:"showOnHome",id:"showOnHome",checked:s.showOnHome,onChange:c,className:"w-5 h-5 rounded border-zinc-600 text-lime-500 focus:ring-lime-500 bg-black/50"}),e.jsx("label",{htmlFor:"showOnHome",className:"text-sm text-zinc-300 select-none cursor-pointer",children:"Show on Home Page (Selected Works)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm text-zinc-400",children:"Title"}),e.jsx("input",{type:"text",name:"title",value:s.title,onChange:c,className:"w-full rounded-2xl border border-white/10 bg-black/40 px-4 py-3 text-sm focus:border-lime-400 focus:outline-none",required:!0})]}),e.jsxs("div",{className:"space-y-2 md:col-span-2",children:[e.jsx("label",{className:"text-sm text-zinc-400",children:"Artists"}),e.jsx("div",{className:"flex flex-wrap gap-3",children:x.map(t=>{const a=s.artistIds.includes(String(t.id));return e.jsx("button",{type:"button",onClick:()=>K(t.id),className:`px-4 py-2 rounded-full border transition-colors text-sm ${a?"border-lime-400 bg-lime-500/20 text-white":"border-white/10 bg-black/40 text-zinc-300 hover:border-lime-300/60 hover:text-white"}`,children:t.name},t.id)})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm text-zinc-400",children:"Price (USD)"}),e.jsx("input",{type:"number",name:"price",step:"0.01",value:s.price,onChange:c,className:"w-full rounded-2xl border border-white/10 bg-black/40 px-4 py-3 text-sm focus:border-lime-400 focus:outline-none"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm text-zinc-400",children:"Duration"}),e.jsx("input",{type:"text",name:"duration",value:s.duration,onChange:c,className:"w-full rounded-2xl border border-white/10 bg-black/40 px-4 py-3 text-sm focus:border-lime-400 focus:outline-none",placeholder:"3:45"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm text-zinc-400",children:"Service Type"}),e.jsx("input",{type:"text",name:"type",value:s.type,onChange:c,className:"w-full rounded-2xl border border-white/10 bg-black/40 px-4 py-3 text-sm focus:border-lime-400 focus:outline-none",placeholder:"Production, Mixing..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm text-zinc-400",children:"Genres (comma separated)"}),e.jsx("input",{type:"text",name:"genres",value:s.genres,onChange:c,className:"w-full rounded-2xl border border-white/10 bg-black/40 px-4 py-3 text-sm focus:border-lime-400 focus:outline-none"})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"md:col-span-2 flex items-center gap-3 p-4 rounded-2xl border border-white/10 bg-black/40",children:[e.jsx("input",{type:"checkbox",name:"showOnHome",id:"showOnHome",checked:s.showOnHome,onChange:c,className:"w-5 h-5 rounded border-zinc-600 text-lime-500 focus:ring-lime-500 bg-black/50"}),e.jsx("label",{htmlFor:"showOnHome",className:"text-sm text-zinc-300 select-none cursor-pointer",children:"Show on Home Page (Selected Works)"})]}),["spotify","apple","tidal","qobuz"].map(t=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm text-zinc-400 capitalize",children:[t," link"]}),e.jsx("input",{type:"url",name:t,value:s[t],onChange:c,className:"w-full rounded-2xl border border-white/10 bg-black/40 px-4 py-3 text-sm focus:border-lime-400 focus:outline-none",placeholder:"https://..."})]},t))]}),e.jsxs("div",{className:"space-y-4 pt-4 border-t border-white/10",children:[e.jsx("p",{className:"text-sm font-semibold text-zinc-300",children:"Embed Players"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs text-zinc-400",children:"Apple Music Embed Code"}),e.jsx("textarea",{name:"embedApple",value:s.embedApple,onChange:c,className:"w-full rounded-2xl border border-white/10 bg-black/40 px-4 py-3 text-sm focus:border-lime-400 focus:outline-none min-h-[100px] font-mono text-xs",placeholder:"<iframe ... src='embed.music.apple.com' ...></iframe>"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs text-zinc-400",children:"SoundCloud Embed Code"}),e.jsx("textarea",{name:"embedSoundcloud",value:s.embedSoundcloud,onChange:c,className:"w-full rounded-2xl border border-white/10 bg-black/40 px-4 py-3 text-sm focus:border-lime-400 focus:outline-none min-h-[100px] font-mono text-xs",placeholder:"<iframe ... src='w.soundcloud.com/player' ...></iframe>"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs text-zinc-400",children:"Custom Embed"}),e.jsx("textarea",{name:"embed",value:s.embed,onChange:c,className:"w-full rounded-2xl border border-white/10 bg-black/40 px-4 py-3 text-sm focus:border-lime-400 focus:outline-none min-h-[80px] font-mono text-xs",placeholder:"Any other iframe code"})]}),e.jsx("p",{className:"text-xs text-zinc-500",children:"Paste the full iframe code. Multiple players will be stacked vertically on the song card."})]}),e.jsxs("div",{className:"flex gap-3 justify-end pt-4",children:[e.jsx(g,{variant:"ghost",type:"button",onClick:()=>m(!1),children:"Cancel"}),e.jsx(g,{type:"submit",variant:"primary",disabled:k,children:k?"Saving...":h?"Update Song":"Add Song"})]})]})}),e.jsx(te,{open:!!w,onClose:()=>S(null),song:w})]})};export{ue as default};
